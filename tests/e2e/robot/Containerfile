FROM python:3.11-alpine

WORKDIR /tests

RUN mkdir output

COPY ./testpypi-requirements.txt /testpypi-requirements.txt

RUN pip install --no-cache-dir -r /testpypi-requirements.txt \
    --index-url https://test.pypi.org/simple --no-deps

COPY ./requirements.txt /requirements.txt

RUN pip install --no-cache-dir --upgrade pip==23.3.1 \
    && pip install --no-cache-dir -r /requirements.txt

COPY ./MCCRobotLibrary.py ./

COPY ./TestCommands.robot ./

COPY ./commands_test_data.json ./

CMD [ "python", "-m", "robot", "-x", "xunit.xml", "-d", "./output", "./TestCommands.robot"]
# CMD [ "python", "-m", "robot", "-d", "./output", "--variable", "DYNAMICTESTS:TestCommands.GetPlayerInventoryCommand", "./TestCommands.robot"]
